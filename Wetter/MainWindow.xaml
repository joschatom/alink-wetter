<Window x:Class="Wetter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Wetter"
        xmlns:sys = "clr-namespce:System"
        mc:Ignorable="d"
        Height="300" Width="500"

        d:DataContext="{Binding DataSource, RelativeSource = {RelativeSource Mode=FindAncestor, AncestorType=local:MainWindow}}"
        Title="{Binding City.Name, StringFormat=Weather at {0}}" WindowStartupLocation="CenterScreen">
    <Window.Background>
        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
            <GradientStop Color="#FF0B102B" Offset="1"/>
            <GradientStop Color="#FF0E1E79"/>
            <GradientStop Color="#FF0C1859" Offset="0.39"/>
            <GradientStop Color="#FF190B39" Offset="0.807"/>
            <GradientStop Color="#FF071B6D" Offset="0.163"/>
            <GradientStop Color="#FE340C7D" Offset="0.067"/>
        </LinearGradientBrush>
    </Window.Background>

    <Grid x:Name="Root">
        <Grid.Resources>
            <Style TargetType="Run" >
                <Setter Property="Foreground" Value="White"/>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding}" Value="{x:Null}">
                        <Setter Property="Foreground" Value="Red" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Grid.Resources>

        <Expander Panel.ZIndex="2" Margin="5,0,239,0">
            <local:Picker ChangeView="ViewPick_ChangeView" x:Name="ViewPick" 
                          HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,60,0,0" Height="180" Width="181"
                          />
        </Expander>

        <TextBlock Margin="80,4,239,0" VerticalAlignment="Top" Foreground="White">
            Last Updated: 
            <Run Language="ch-DE" Text="NEVER" Name="LastUpdatedDisplay"
                   FontSize="12" />
        </TextBlock>


        <StackPanel>


            <TextBox KeyDown="CityInput_KeyDown" Height="31"
                     Width="164" x:Name="LocationName"
                     FontSize="16" Foreground="White" BorderThickness="0,0,0,2"
                     Background="{x:Null}"
                     SelectionBrush="White" SelectionTextBrush="Black"
                     CaretBrush="#FFFF9337" VerticalAlignment="Bottom" 
                     HorizontalAlignment="Right" 
                     HorizontalContentAlignment="Right" VerticalContentAlignment="Center"
                     />

            <Label HorizontalAlignment="Right" HorizontalContentAlignment="Right" Height="29" VerticalAlignment="Top" Width="164" FontSize="16">
                <Run Text="{Binding LastUpdated.TimeOfDay, FallbackValue=Not Fetched, Mode=OneTime}" ToolTip="Date of weather info"/>
            </Label>

            <Label HorizontalContentAlignment="Right"  HorizontalAlignment="Right" Height="32" Width="164" Foreground="White" FontSize="16">
                <Run Text="{Binding Description, FallbackValue=No Data, Mode=OneWay}" d:Text="Weather Desc"/>
            </Label>
        </StackPanel>

        <TextBlock HorizontalAlignment="Left" Height="38" VerticalAlignment="Top" FontSize="25" Margin="66,30,0,0">
            <Run Text="{Binding Main.Temp, FallbackValue='0°C', StringFormat={}{0}°C}"/>
            (<Run Text="{Binding Main.feels_like, Mode=OneTime, FallbackValue='0°', StringFormat={}{0}°C}" ToolTip="Feels like"/>)
        </TextBlock>

        <TextBlock Margin="10,68,239,10">
            Minimum Temperature : <Run Text="{Binding Main.temp_min, FallbackValue='0°', StringFormat={}{0}°}" /><LineBreak/>
            Maximum Temperature: <Run Text="{Binding Main.temp_max, FallbackValue='0°', StringFormat={}{0}°}"/><LineBreak/>
        </TextBlock>

        <TextBlock  Margin="270,100,12,0" VerticalAlignment="Top"  Foreground="White">
            Sunset: <Run Text="{Binding LocalSunset, Mode=OneWay, FallbackValue='6PM'}"/><LineBreak/>
            Sunrise: <Run Text="{Binding LocalSunrise, Mode=OneWay, FallbackValue='6AM'}"/><LineBreak/>
            Humidity: <Run Text="{Binding Main.humidity, FallbackValue='100%', StringFormat={}{0}%}"/><LineBreak/>
            Wind: <Run Text="{Binding Wind.Speed, FallbackValue='0m/s', StringFormat={}{0}m/s}" ToolTip="Speed"/>,
            <Run Text="{Binding Wind.Deg, FallbackValue='0°', StringFormat={}{0}°}" ToolTip="Direction"/>,
            <Run Text="{Binding Wind.Gust, FallbackValue='0m/s', StringFormat={}{0}m/s}" ToolTip="Gust"/><LineBreak/>
            Clouds: <Run Text="{Binding Main.humidity, FallbackValue='100%', StringFormat={}{0}%}"/><LineBreak/>
            See Level: <Run Text="{Binding Main.sea_level, FallbackValue='0m', StringFormat={}{0}m}"/><LineBreak/>
            Ground Level: <Run Text="{Binding Main.grnd_level, FallbackValue='0m', StringFormat={}{0}m}"/><LineBreak/>
        </TextBlock>

        <Label HorizontalAlignment="Left" Height="25" Width="60" FontSize="12" VerticalAlignment="Top" BorderThickness="2,0,0,0" Margin="20,-1,0,0">
            <Run Text="{Binding UTCTimezone,Mode=OneWay,  FallbackValue='No Data'}"/>
        </Label>

        <Image HorizontalAlignment="Left" Height="50"
               Margin="0,25,0,0" VerticalAlignment="Top"
               Width="62"
               RenderTransformOrigin="0.5,0.5"
               Source="{Binding Icon}">
        </Image>

        <Button Height="30" HorizontalAlignment="Right"
                Padding="5" VerticalAlignment="Bottom"
                Margin="10" Background="#3F000000"
                Foreground="White" BorderBrush="White"
                Click="Update_Click" Content="Update" Focusable="False">
        </Button>

        <TreeView Name="Tree" HorizontalAlignment="Left" 
                  Height="123" Margin="10,105,0,0" VerticalAlignment="Top"
                  Width="255" Background="{x:Null}" Focusable="False"
                  Visibility="Hidden">
        </TreeView>


    </Grid>
</Window>