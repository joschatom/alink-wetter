<Window x:Class="Wetter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Wetter"
        xmlns:sys = "clr-namespce:System"
        mc:Ignorable="d"
        Height="280" Width="500"
        ResizeMode="CanMinimize"
        d:DataContext="{Binding LocalWeather, RelativeSource = {RelativeSource Mode=FindAncestor, AncestorType=local:MainWindow}}"
        Title="{Binding name, StringFormat=Weather at {0}}" WindowStartupLocation="CenterScreen">

    <Window.Background>
        <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
            <GradientStop Color="#FF0B102B" Offset="1"/>
            <GradientStop Color="#FF0E1E79"/>
            <GradientStop Color="#FF0C1859" Offset="0.39"/>
            <GradientStop Color="#FF190B39" Offset="0.807"/>
            <GradientStop Color="#FF071B6D" Offset="0.163"/>
            <GradientStop Color="#FE340C7D" Offset="0.067"/>
        </LinearGradientBrush>
    </Window.Background>

    <Grid>
        <Grid.Resources>
            <Style TargetType="Run" >
                <Setter Property="Foreground" Value="White"/>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding}" Value="{x:Null}">
                        <Setter Property="Foreground" Value="Red" />
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Grid.Resources>

        <TextBlock Margin="60,5,239,0" VerticalAlignment="Top" Foreground="White">
            Last Updated: 
            <Run Language="ch-DE" Text="NEVER" Name="LastUpdatedDisplay"
                   FontSize="12" />
        </TextBlock>

        <StackPanel Grid.ColumnSpan="2" >
            <TextBox KeyDown="CityInput_KeyDown" Height="29" HorizontalContentAlignment="Center" 
                     HorizontalAlignment="Right" VerticalAlignment="Top" Width="164" x:Name="LocationName"
                     FontSize="16" Grid.ColumnSpan="2" Foreground="White" BorderThickness="0,0,0,2"
                     Background="{x:Null}" VerticalContentAlignment="Center" SelectionBrush="White" SelectionTextBrush="Black" CaretBrush="#FFFF9337"/>

            <Label HorizontalAlignment="Right" HorizontalContentAlignment="Right" Height="29" VerticalAlignment="Top" Width="164" FontSize="16">
                <Run Text="{Binding LastUpdated, Mode=OneTime, FallbackValue='Not Fetched'}" ToolTip="Date of weather info"/>
            </Label>

            <Label HorizontalContentAlignment="Right"  HorizontalAlignment="Right" Height="32" Width="164" Foreground="White" FontSize="16">
                <Run Text="{Binding weather[0].description, Mode=OneWay, FallbackValue='No Data'}" d:Text="Weather Desc"/>
            </Label>
        </StackPanel>

        <TextBlock HorizontalAlignment="Left" Height="38" VerticalAlignment="Top" FontSize="25" Margin="46,30,0,0">
            <Run Text="{Binding main.Temp, FallbackValue='0°C', StringFormat={}{0}°C}"/>
            (<Run Text="{Binding main.feels_like, Mode=OneTime, FallbackValue='0°', StringFormat={}{0}°C}" ToolTip="Feels like"/>)
        </TextBlock>

        <TextBlock Margin="10,68,239,0">
            Minimum Temperature : <Run Text="{Binding main.temp_min, FallbackValue='0°', StringFormat={}{0}°}" /><LineBreak/>
            Maximum Temperature: <Run Text="{Binding main.temp_max, FallbackValue='0°', StringFormat={}{0}°}"/><LineBreak/>
        </TextBlock>

        <TextBlock  Margin="270,100,12,0" VerticalAlignment="Top"  Foreground="White">
            Sunset: <Run Text="{Binding LocalSunset, Mode=OneWay, FallbackValue='6PM'}"/><LineBreak/>
            Sunrise: <Run Text="{Binding LocalSunrise, Mode=OneWay, FallbackValue='6AM'}"/><LineBreak/>
            Humidity: <Run Text="{Binding main.humidity, FallbackValue='100%', StringFormat={}{0}%}"/><LineBreak/>
            Wind: <Run Text="{Binding wind.Speed, FallbackValue='0m/s', StringFormat={}{0}m/s}" ToolTip="Speed"/>,
            <Run Text="{Binding wind.Deg, FallbackValue='0°', StringFormat={}{0}°}" ToolTip="Direction"/>,
            <Run Text="{Binding wind.Gust, FallbackValue='0m/s', StringFormat={}{0}m/s}" ToolTip="Gust"/><LineBreak/>
            Clouds: <Run Text="{Binding main.humidity, FallbackValue='100%', StringFormat={}{0}%}"/><LineBreak/>
            See Level: <Run Text="{Binding main.sea_level, FallbackValue='0m', StringFormat={}{0}m}"/><LineBreak/>
            Ground Level: <Run Text="{Binding main.grnd_level, FallbackValue='0m', StringFormat={}{0}m}"/><LineBreak/>
        </TextBlock>

        <Label HorizontalAlignment="Left" Height="25" Width="60" FontSize="12" VerticalAlignment="Top" BorderThickness="2,0,0,0">
            <Run Text="{Binding UTCTimezone,Mode=OneWay,  FallbackValue='No Data'}"/>
        </Label>

        <Image HorizontalAlignment="Left" Height="50"
               Margin="0,25,0,0" VerticalAlignment="Top"
               Width="62"
               RenderTransformOrigin="0.5,0.5"
               Source="{Binding Icon}">
        </Image>

        <Button Height="30" HorizontalAlignment="Right"
                Padding="5" VerticalAlignment="Bottom"
                Margin="10" Background="#3F000000"
                Foreground="White" BorderBrush="White"
                Click="Update_Click" Content="Update" Focusable="False">
        </Button>

        <TreeView Name="Tree" HorizontalAlignment="Left" 
                  Height="115" Margin="10,105,0,0" VerticalAlignment="Top"
                  Width="251" Background="{x:Null}" Focusable="False">
        </TreeView>

    </Grid>
</Window>